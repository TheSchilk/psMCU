@include StdLib.psASM

@define SCRT1 0x09

# Enable Interrupts:
MAIN: LITA 0x1
SVA SYS3
JMP TEST1

INTERRUPT: LITA 1
SVA SCRT1
LITA 0
LITB 0
RTRNI

# Test 1: SHFTLL 1 and Invert
# Start with 0 in A, Repeatability Shift Left 1 and Invert
TEST1: LITA 0
SVA SCRT1
LITB 0

LOOP1: 
SHFTLL 1
NOTA
IFSM SCRT1, 0 
    JMP TEST2
JMP LOOP1

# Test 2: SHFTLL SHFTRL
# Shift 0x01 Left and Right 1,2,4 bits
TEST2: LITA 0
SVA SCRT1
LITA 0x01
LOOP2: 
SHFTLL 1
SHFTRL 1
SHFTLL 2
SHFTRL 2
SHFTLL 4
SHFTRL 4

IFSM SCRT1, 0 
    JMP TEST3
JMP LOOP2

# Test 3: SHFTR and SHFTL
# Shift 0x01 Left and Right 1,2,4 bits 
TEST3: 
LITA 0
SVA SCRT1

LOOP3: 
LITA 1
LITB 1
SHFTL
SHFTR
LITB 2
SHFTL
SHFTR 
LITB 4
SHFTL
SHFTR

IFSM SCRT1, 0
    JMP TEST4
JMP LOOP3

# Test 4: SHIFTIN
# Shift 0x01 left and right 6 steps, shifting in 1s on the left shift.
TEST4: 
LITA 0
SVA SCRT1

LOOP4: 
LITA 1
LITB 1
SVB SYS1
SHFTLL 6
LITB 0
SVB SYS1
SHFTRL 6

IFSM SCRT1, 0
    JMP TEST5
JMP LOOP4

# Test 5: ADD ADDLA and SUB
# Add 1 and Subtract 1 from A
TEST5: 
LITA 0
SVA SCRT1

LOOP5: 
LITB 1
ADD
ADD
ADD
ADD
ADD
ADD
ADD
ADD
SUB
SUB
SUB
SUB
SUB
SUB
SUB
ADDLA 1

IFSM SCRT1, 0
    JMP TEST6
JMP LOOP5

# Test 6:  COMPB
# A = A - B + B + 1, B = A using COMPB
TEST6: 
LITA 0
SVA SCRT1
LITB 1

LOOP6: 
ADD
COMPB
ADD
COMPB
ADDLA 1
CPY

IFSM SCRT1, 0
    JMP TEST1
JMP LOOP6
