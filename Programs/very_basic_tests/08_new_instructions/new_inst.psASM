@include StdLib.psASM
#
# PUSHA PUSHB PUSHM
# POPA POPB POPM
# ADDLA ADDLB
#

MAIN:
# Add literals to A and B
LITA 0x00
LITB 0x00
ADDLA 1
ADDLA 1
ADDLA 1
ADDLB 1
ADDLB 0xFF
ADDLB 1
LITA 0
LITB 0
ADDLB 1
ADDLB 1
ADDLB 1
ADDLB 1
SWP
SUBL 1
SUBL 3
SUBL 1
HALT

# Make sure we did not break COMPB,SUB:
LITA 8
LITB 1
SUB
SUB
SUB
SUB
COMPB
ADD
ADD
ADD
ADD
HALT


# Push b, b+=2 <= 8 Times. 
LITA 0
LITB 0
PUSHB
ADDLB 2
PUSHB
ADDLB 2
PUSHB
ADDLB 2
PUSHB
ADDLB 2
PUSHB
ADDLB 2
PUSHB
ADDLB 2
PUSHB
ADDLB 2
PUSHB
HALT

# Pop into B and A 
POPB
POPA
POPB
POPA
POPB
POPA
POPB
POPA
HALT

@define SCRT1 0x09

# PUSHM and POPM 
LITA 1
SVA SCRT1
PUSHM SCRT1
LITA 2
SVA SCRT1
PUSHM SCRT1
LITA 3
SVA SCRT1
PUSHM SCRT1
LITA 4
SVA SCRT1
PUSHM SCRT1

POPM 0x00
POPM 0x01
POPM 0x02
POPM 0x03
HALT
JMP MAIN

